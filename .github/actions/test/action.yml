name: Test F# Project
description: Run tests for the F# project

runs:
  using: composite
  steps:
    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'
    
    - name: Install Fantomas
      run: dotnet tool install -g fantomas
      shell: bash
    
    - name: Restore dependencies
      run: dotnet restore
      shell: bash
    
    - name: Build
      run: dotnet build --no-restore
      shell: bash

    - name: Check C# format
      run: dotnet format ical2s3grpc.csproj --verify-no-changes --verbosity diagnostic
      shell: bash
    
    - name: Check F# format
      run: fantomas Core --check
      shell: bash
    
    - name: Test
      run: dotnet test --no-build --verbosity normal
      shell: bash